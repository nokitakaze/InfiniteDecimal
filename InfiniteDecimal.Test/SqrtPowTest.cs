namespace InfiniteDecimal.Test;

public class SqrtPowTest
{
    public static decimal[] GetTestDecimal(bool shortType = false)
    {
        var values = new List<decimal>()
        {
            0,
            1,
            2,
            (decimal)Math.PI,
            (decimal)Math.Pow(Math.E, 2),
            (decimal)Math.Pow(Math.E, 1.5d),
            1.337m,
            1234m,
            1.000_000_01m,
            0.000_000_01m,
        };
        if (!shortType)
        {
            values.AddRange(new decimal[]
            {
                (decimal)Math.Sqrt(Math.E),
                15m,
                911,
                228,
            });
        }

        var xModifiers = shortType
            ? new decimal[] { 0.5m, 1m, 2m, }
            : new decimal[] { 0.5m, 1m, 1.5m, 2m, 3m, };

        var pModifier = new decimal[] { 1m, 0.1m, 0.001m, 0.000_01m, 0.000_000_1m, };
        var modifiedE = xModifiers
            .Select(x => (decimal)Math.E * x)
            .SelectMany(v => pModifier.SelectMany(p => new decimal[] { v + p, v - p, v + 2 * p, v - 2 * p, }))
            .SelectMany(v => new decimal[] { v, 1m / v })
            .ToArray();

        return values
            .Concat(modifiedE)
            .Concat(shortType ? Array.Empty<decimal>() : values.Select(t => t - 1))
            .Concat(shortType ? Array.Empty<decimal>() : values.Select(t => t + 1))
            .Distinct()
            .Where(x => x >= 0)
            .OrderBy(t => t)
            .ToArray();
    }

    #region Ln & Sqrt

    public static object[][] TestSqrtData()
    {
        var values = GetTestDecimal();

        return values.Select(value => new object[] { value }).ToArray();
    }

    [Theory]
    [MemberData(nameof(TestSqrtData))]
    public void TestPowSqrtThroughDecimal(decimal input)
    {
        if (input < 0)
        {
            return;
        }

        var powExpected = input * input;
        var powActual = (new BigDec(input)).Pow(2);

        var sqrtActual = powActual.Sqrt();
        if (TrivialMathTests.IsInt(input))
        {
            Assert.True(powExpected == powActual);
            Assert.Equal(new BigDec(input), sqrtActual);
        }
        else
        {
            var diff = (powExpected - powActual).Abs();
            Assert.True(diff < 0.000_000_1m);

            diff = (sqrtActual - input).Abs();
            Assert.True(diff < 0.000_000_1m);
        }

        {
            var actual2a = powActual.Pow(0.5m);
            var diff = (actual2a - input).Abs();
            Assert.True(diff < 0.000_000_1m);

            var actual2b = powActual.Pow(0.5d);
            diff = (actual2b - input).Abs();
            Assert.True(diff < 0.000_000_1m);
        }
    }

    [Theory]
    [MemberData(nameof(TestSqrtData))]
    public void TestLnThroughDouble(decimal input)
    {
        if (input <= 0)
        {
            return;
        }

        var expectedDouble = Math.Log((double)input);
        var expected = new BigDec(expectedDouble);
        var actual = new BigDec(input).Ln().WithPrecision(20);

        var diff = (actual - expected).Abs();
        Assert.True(diff < 0.000_000_1m);

        var actualExp = actual.Exp();
        diff = (actualExp - input).Abs();
        Assert.True(diff < 0.000_000_1m);
    }

    [Fact]
    public void TestLn_Euler()
    {
        var expected = BigDec.One;
        var actual = new BigDec(BigDec.E).Ln().WithPrecision(20);

        var diff = (actual - expected).Abs();
        var epsilon = BigDec.Parse("0.00000000000000000001");
        Assert.True(diff < epsilon);

        var actualExp = actual.Exp();
        diff = (actualExp - BigDec.E).Abs();
        Assert.True(diff < 0.000_000_1m);
    }

    #region Test Ln Picked

    public static object[][] TestLnPickedData()
    {
        var composites = new[]
        {
            ("0.000001",
                "-13.81551055796427410410794872810618524560660893177263785619996740580543565806411488141598323053758979"),
            ("0.000002",
                "-13.1223633774043287946907166066480086775311087974123826020792873963120420360944201658101199035411711"),
            ("0.007",
                "-4.961845129926823746948621620609912893166219736304457739640593552965137966279988172920333116680923368"),
            ("0.007001",
                "-4.961702282987076523557575656028214117694587326380440023592461283470763035663586598116065814459605042"),
            ("1.493",
                "0.4007875185570533334691793883512485745360367900807287943043152627153452052398502297307225680615836674"),
            ("1.499999",
                "0.4054644414412754929903587450939524287384284580826473972540356444919301951765613323748578799926850811"),
            ("1.5",
                "0.4054651081081643819780131154643491365719904234624941976140143241441006712489142512677524278173134012"),
            ("1.500001",
                "0.4054657747746088265212229426248693011664120138994871647168675621325681210197912458968680674843875804"),
            ("1.507",
                "0.4101209196443584073231593418919020675815375620956635621688580472580011737440636191120625374702628053"),
            ("1.993",
                "0.6896410412306576667010048464198482099831532944788170696662736512213228707593314747454676263808714625"),
            ("1.999999",
                "0.6931466805598203093755654391665036514062292999108500039344510907449436767868190314390508599258624243"),
            ("2.0",
                "0.6931471805599453094172321214581765680755001343602552541206800094933936219696947156058633269964186875"),
            ("2.000001",
                "0.6931476805598203094588987724998494847395626354763261944110755947131977338191963763351757853476669151"),
            ("2.007",
                "0.6966410698142010893726213195150988131903049242301667984797773269704070348411474241716457955594147821"),
            ("2.711281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427",
                "0.9974215224940224634561202698699743161882402282562014148085853411708452109910810621746301388334473548"),
            ("2.718280828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427",
                "0.9999996321204911608994644040954171213585074907545066275032255189055651135796178932246828122291623427"),
            ("2.718281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427",
                "1.0"),
            ("2.718282828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427",
                "1.000000367879373503817298974054869434778603627257519567656905101142954370212982382514975313114498736"),
            ("2.725281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427",
                "1.002571846055110920827996458450611952656143605331169042470306286669689623041032448050902755051947876"),
            ("3.134592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068",
                "1.142499230583515804761015177629764510159584675427543153370800491730141014132441620554850207014418934"),
            ("3.141591653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068",
                "1.144729567539463329750184130655580646601506094355574586861395460996990952727856815217972511685433236"),
            ("3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068",
                "1.144729885849400174143427351353058711647294812915311571513623071472137769884826079783623270275489708"),
            ("3.141593653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068",
                "1.144730204159235697353028229146101769887359488768653920052203505230681077269317366735838570543878217"),
            ("3.148592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068",
                "1.146955576364961716486819284064764433684094502383918054202326559815713745425220548971094091528266058"),
            ("1336.993",
                "7.19817834148614312463418893803734441095611515024743442892736189952549557138841454931017368362855058"),
            ("1336.999999",
                "7.198183576354000021355473542058012976530385346224204904024587530633087351030214594321858014341928682"),
            ("1337.0",
                "7.198183577101943177955302695645546876245526206049408219940102037466273301958175635543426603486394709"),
            ("1337.000001",
                "7.198183577849886333995712884146977805792964737996330202318320755728141889512542320487506883254037"),
            ("1337.007",
                "7.198188812690331701986821711754205469745660520668462020517984475688074583193915945479475784025708999"),
            ("999999.993",
                "13.8155105509642740796079486137728513120232722370392849146998497568047150579346311472766245943467217"),
            ("999999.999999",
                "13.81551055796327410410794822810618524527327559843905452286663387247210232456411488141584037339473252"),
            ("1000000.0",
                "13.81551055796427410410794872810618524560660893177263785619996740580543565806411488141598323053758979"),
            ("1000000.000001",
                "13.81551055796527410410794822810618524593994226510572118953330093913876899123078154808279275434711347"),
            ("1000000.007",
                "13.81551056496427407960794884243951797868994562650595158136675172147138172461026528216551348359512454"),
            ////////////////////// reverse
            ("0.00000000000009292348335811760027214213343881539824520650543736040562918677357594992984982435026884986073172095116",
                "-30.007"),
            ("0.00000000000009357613611221884574666043956609791236372826613505017110509715550730449289603356374519768856705185767",
                "-30.000001"),
            ("0.00000000000009357622968840174604915832223378706744958322688935880416413318619960842833767616873665639476198701617",
                "-30.0"),
            ("0.00000000000009357632326467822258134461444554452155807741277900054942412880733038696496867892700668215406087168298",
                "-29.999999"),
            ("0.00000000000009423356127266369804955052364782129757507572692009627169743384278581724630118837067220888050762463783",
                "-29.993"),
            ("0.000000002046775927721868483461959868776874707006123411044678917514341580415016688359276659396490095741355541",
                "-20.007"),
            ("0.000000002061151561285965965875806175271047911413170637141867621131775510143561847380971287432135645164580472",
                "-20.000001"),
            ("0.000000002061153622438557827965940380155820976375807275599103692972244661629164023784559353279910927905581367",
                "-20.0"),
            ("0.000000002061155683593210843678513314631361851604144158923410014613062689189964568561463770948575215069390053",
                "-19.999999"),
            ("0.000000002075632314095149822684391299884250243608179541682625756764230940988416001153535960610290214823224727",
                "-19.993"),
            ("0.0000003037684814083094976429407503183251193198400126602641177016150099051930265311691655372368005186664534",
                "-15.007"),
            ("0.0000003059020145996582376549583317792675171586145030704934934153544877771807788901001745523332522493746087",
                "-15.000001"),
            ("0.0000003059023205018257883714794977022896393708207808185591165592618273978584313740111581584540286257057303",
                "-15.0"),
            ("0.0000003059026264042992414085025149055432829003947744973476780384379987878447147892794257953726947750363001",
                "-14.999999"),
            ("0.0000003080511488702527244938709662960479284286580648632187228048789418986011142747813116810168066827695206",
                "-14.993"),
            ("0.00004508323996159952044414657529172023096352195564741317516530638964381996914403698876410989752747475644",
                "-10.007"),
            ("0.00004539988436257778900805456932605206529334005571838250819595165664739392072044223203393484475501549378",
                "-10.000001"),
            ("0.00004539992976248485153559151556055061023791808886656496925907130565099942161430228165252500454594778232",
                "-10.0"),
            ("0.00004539997516243731399289095042991222690525374484028521640763232552957511034446883377060550092264147862",
                "-9.999999"),
            ("0.0000457188441690123285015750167151101774656189323704109917657436348298785294066772205694594574299100516",
                "-9.993"),
            ("0.00008013659348023254317503492728074715174635809818877772478295060193734284159166453020585600687445544493",
                "-9.431777960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("0.0000806994368708273786799410307863607618502761992463500508687028801882939561256460990746051269721307883",
                "-9.424778960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("0.00008069951757030459923920503392434662395298151949412112206883381253792311184414749992388626068803806802",
                "-9.424777960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("0.00008069959826986251931603934838653148861521862162618218526262758095080225522321374301404492406033007746",
                "-9.424776960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("0.00008126639595288425507544589038360415603820073173551663632989434401995285666994037220202468385687384861",
                "-9.417777960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("0.0002853353264260146897375634724421068277362012343164603145889428041873065733987957024503603508801525119",
                "-8.161845485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("0.0002873393934272120588651189251495232374512009704534191328836637498839284752506857729569818120177018686",
                "-8.154846485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("0.0002873396807667491558217813071748934102103797661596977363139044979706736745934578476442542455139222068",
                "-8.154845485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("0.0002873399681065735924592104623010587615066279395378699682149988760056449641566666684029727787133372772",
                "-8.154844485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("0.0002893581148093331676448694753307829298917810546593219691181776683894357822522515102946908299204487515",
                "-8.147845485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("0.001263756471633468551762598433003629080854125475490580106106265595241499746883214445772475278759929783",
                "-6.673666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.001272632528706643300212378859530110097507056452144344625828828825164280177201905243560378506031333212",
                "-6.666667666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.001272633801339808323332137868036549001798626433812455277373408151091785038979406312618150328835963164",
                "-6.666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.001272635073974245980253236790919136822279128336053130866866816007798891446642815611456763705817818302",
                "-6.666665666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.001281573490357046974494885844520509220201943872439575392814583657818255043857513852997852325234160817",
                "-6.659666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.00185441627836404441302100942703714240552203133282300044798388005651002228740326545568837108346364971",
                "-6.290185307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("0.001867440864266190827496012121546744129600819643838120995153136813066175076493073344377062622792882194",
                "-6.283186307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("0.00186744273170798881443021293482703039342280500247531719938153863831793512291572807390648490546536229",
                "-6.283185307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("0.001867444599151654244096121892541974512517205934945091950202787039830201790043325309268466189676391076",
                "-6.283184307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("0.001880560690119431684146569681508914177857574876395443021083616785174969129410381065419222588680883155",
                "-6.276185307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("0.002461461499403654540840650316921609349902287691113296098093890860551809123634473917927481798627135079",
                "-6.007"),
            ("0.002478749697915421132361952305364353292880039959290450889214765788593497476965496081904603539553618134",
                "-6.000001"),
            ("0.002478752176666358423045167430816667891506479585533945050878624006276194228293990182374720401582667818",
                "-6.0"),
            ("0.002478754655419774465905049121254709046433823222812527156534998499039402631157100148953985429189167044",
                "-5.999999"),
            ("0.002496164313281676764890879868601252945391000704393012896815419208683997450624572715044096471808191575",
                "-5.993"),
            ("0.004324046363417914896830880148614502796083748376258708633977944989861203077283282332136677863763015591",
                "-5.443563656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("0.004354416520303554767136687330572105141480784743158092909532583693285367696583920869690371582277663052",
                "-5.436564656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("0.004354420874722252279677342512794321151232492460180574362344187355268638483787859247398120550611717666",
                "-5.436563656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("0.004354425229145304213092720310164620730363446751673726401690492423638285066449250889469869070518833355",
                "-5.436562656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("0.004385008753520699519274269007733022718822136310643620942735562921061795673667827635249046724141132828",
                "-5.429563656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("0.006690946065280509148480860298201540881828522351640492290180273920948989165791537848876601149736435101",
                "-5.007"),
            ("0.006737940261141836983545503634881810087543063892030015782602019910469812650473757432073692272495596828",
                "-5.000001"),
            ("0.006737946999085467096636048423148424248849585027355085430305531572683522515604062281449138844208361548",
                "-5.0"),
            ("0.006737953737035835156725679240007257715720229159374944334897080654878188727202642899941884191925115268",
                "-4.999999"),
            ("0.006785278093641533330061044809996197931923081111804743303082042091232408090172649731131325615360651776",
                "-4.993"),
            ("0.008920627561964182878407819320714645707960189018689325427218336310349163341018285703264725623873573228",
                "-4.719388980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("0.008983282037842898404250412161033657976740644959398639931484801082067728514214045557584924512068284837",
                "-4.712389980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("0.008983291021129427889664951907925253721337766206181967367767945990529757021081087603785285814410720441",
                "-4.712388980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("0.008983300004424940666100621831314099511986757098269095975988349765358499138806279312986846019886230168",
                "-4.712387980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("0.009046394663352117990466685861270430121707605159232290843390085790611402007690503433432423342247710105",
                "-4.705388980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("0.01103150509893530361887909705112774864658063426591004499650038072507523108510479691675687084074110199",
                "-4.507"),
            ("0.01110898542925132275025426033687869117727148666229880438874466973871268277016698275965275872346584601",
                "-4.500001"),
            ("0.01110899653824230649614313428693052777153926750577133022641468813337046830853835136659755784150802132",
                "-4.5"),
            ("0.01110900764724439923857025146922821902031704521266059286710968470093658563271395483588343528359715343",
                "-4.499999"),
            ("0.01118703232060241193423956769534375872296350841835257830125951154183758139677496577532236826590361564",
                "-4.493"),
            ("0.01683285339962794409088523849884098286116515316296192877089692981028138724271254341043013817837524053",
                "-4.084422742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("0.01695107979120983022050951274430611183071743708003525533052896303341013963244695345974641409831885252",
                "-4.077423742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("0.01695109674229809697306051884042588182271773541699357153735208868948765071456559498356207319385265282",
                "-4.077422742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("0.01695111369340331482235382444611010752511362710399089329194685045277437244247442284518295131105802918",
                "-4.077421742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("0.01707017069210025994151263902293804010277344028556158978365192840653337512613579340662001548048107896",
                "-4.070422742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("0.01818787710445155665222295705620891736770304560453204596229941849761222646937224949805588377655092357",
                "-4.007"),
            ("0.01831562057310444937592948892706259899931235055410030495249175757868417608068953736177265384499121091",
                "-4.000001"),
            ("0.01831563888873418029371802127324124221191206755347559476959992743925043159811412268736949812890205173",
                "-4.0"),
            ("0.01831565720438222685039528932601684417368426037958883194480591882404852911736542256203519230039893778",
                "-3.999999"),
            ("0.01844429814298701197664194459774730481111898470241032694220456759186976139460783937118392673755628354",
                "-3.993"),
            ("0.03542514737085924728810578124749097253772911792844180097254462754086168701493730664561214757409280853",
                "-3.340333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.0356739576732768873427688379285924583275296107209584561063113924524513238647975264499498815181142082",
                "-3.333334333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.0356739933472523976044384802397297862323141712277743955674802788866661605823945800728788235311152459",
                "-3.333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.03567402902126358185945537792130433155513735631666059427358144231734264984238686878801983129045509881",
                "-3.333332333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.03592458735645734644885353531689572455933666214098016973092057408345732037317718040708993517425458513",
                "-3.326333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.04291247711084479269156461925600873746138245265758290885436010090182577218194516115296760587357284118",
                "-3.148592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("0.04321387504987559295409753096882890766181797038054511337331531692316405608257000446761310820129538059",
                "-3.141593653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("0.04321391826377224977441773717172801127572810981063308298071968740105076575701796769813995996190108439",
                "-3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("0.04321396147771212051300171922556138794128416378198535895707876835663898775577832119560103813087033026",
                "-3.141591653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("0.04351747690734103063256045025990427874648506067252104554269378348363394890656051196292014800981117366",
                "-3.134592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("0.04943977583127698268016712859108841160324348223755856264675552572686971159351315012358887534790085345",
                "-3.007"),
            ("0.04978701858082046864128552562561924105002129607140049742012193528655927637384130842828880697077539671",
                "-3.000001"),
            ("0.04978706836786394297934241565006177663169959218842321556762772760606066773019955015405424423663334453",
                "-3.0"),
            ("0.04978711815495720438576717376640601861782816243941189534589814772427524757970575763774833049822232207",
                "-2.999999"),
            ("0.05013680048076250747822694451621608355616779160801714332125176836899099621694838198058832555687187013",
                "-2.993"),
            ("0.06552773253554983200084563960504416279130712744016931503277457855076267692566155727232273487955041688",
                "-2.725281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("0.06598796985730968577117776385047941066096748558721753827385282449771194782871811674828209174617508894",
                "-2.718282828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("0.06598803584531253707679018759684642493857704825279643640247354156673633003075630810408824245337146775",
                "-2.718281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("0.06598810183338137641824792937929321651334484717539986052608961423030479002451214470215948371361484731",
                "-2.718280828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("0.0664515725820347902041933988985070513139620530252414999903097786998358021491368496615323439872069883",
                "-2.711281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("0.1046640062561402839047305451275112924130836163904373164454210083358977496816898599562084777278293156",
                "-2.257"),
            ("0.1053991191626924745135953051560565543687669439502985137149353451546564849887523369123682621888764487",
                "-2.250001"),
            ("0.1053992245618643367832176892406980972684910733772778671488440914098830973188506887932967385354427367",
                "-2.25"),
            ("0.1053993299611415982774019464453915713464434084601161101001721871358294988289835956813429232822848397",
                "-2.249999"),
            ("0.1061396074506805836400830686939326288820135987248060444805573929334466751159713918509130413820960606",
                "-2.243"),
            ("0.1222857081105931452541019958665485253436813576463713888269651303135478598423017906879731903486398891",
                "-2.101395102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("0.1231445879254836358434109613811823023770906725844536144989464365234301036779240713326898739161216727",
                "-2.094396102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("0.1231447110701331336415336497286715181142073744032638387481548264471331308546143847098797904371754991",
                "-2.094395102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("0.1231448342149057761507264814718615233458226198431872347962102989788152909628480798593456453543239444",
                "-2.094394102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("0.1240097481451548030698650698057233456406795587019595063711029007523317674340635333030378550031794553",
                "-2.087395102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("0.1343912442452489095867974363350963830094172370254243779843172080580996457196265052507391731065563474",
                "-2.007"),
            ("0.1353351479013971229003700324184699890867376207728426209795336214407975988071812535663847808823064339",
                "-2.000001"),
            ("0.1353352832366126918939994949724844034076315459095758814681588726540733741014876899370981224906570488",
                "-2.0"),
            ("0.1353354185719635961708655814963330869415982112919986187336036666711214686874511219800629799896594785",
                "-1.999999"),
            ("0.1362859536839334470386818082298532536388903248403142227865054042001791487958287945998439432907951712",
                "-1.993"),
            ("0.1621573878178741545425718193747435938821944795024019321943279806181767018300076768139534438383318157",
                "-1.819187885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("0.1632963083784533551845524321257631445063345567180009026662675088522586253207686818358491974526771812",
                "-1.812188885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("0.1632964716748433818193129015562106489213204369074526612142824877826202426435219411736915014224506578",
                "-1.812187885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("0.1632966349713967049257482279765167724752646139987754429329471507804797746670438300571964589197515163",
                "-1.812186885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("0.1644435570915976321618252830796259813465810535649876859888324923666609598276848501858553620103151653",
                "-1.805187885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("0.2064295005029122587529636890323177156381305553621180632540948526582400085696871665678109068316670889",
                "-1.577796326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("0.207879368471289497538575866436819377059431348532935948832506825353811922649380850136797399510223622",
                "-1.570797326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("0.2078795763507619085469556198349787700338778416317696080751358830554198772854821397886002778654260353",
                "-1.570796326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("0.2078797842304421991316861524649831478588958023479131470206337898487215725923879861749699274133234766",
                "-1.570795326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("0.2093398383394460521783304017305653079598304503428521794380049995159137295189933130108322864904632276",
                "-1.563796326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("0.2215737029829980664661703681487265328919711991567869203531123953981206347496455154277782495451625765",
                "-1.507"),
            ("0.2231299370183812455463374016703582395097037532501651053206163365244861083832813518971131990501520844",
                "-1.500001"),
            ("0.2231301601484298289332804707640125213421716293610793287438353187603251666313144411775637303325775908",
                "-1.5"),
            ("0.2231303832787015424803719882807800960151757351004539369457933421127766209664885056248220744957322859",
                "-1.499999"),
            ("0.2246975507363535635913265862150763208355905740289458866144911077299582354033259792287947551634447172",
                "-1.493"),
            ("0.255089474690337620430890032873539301941776826154843675637554776329593415531410485413337744776388554",
                "-1.366140914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("0.2568811084322333393403865955988076624296529973220071778596247991994112222787041068921380379148572435",
                "-1.359141914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("0.2568813653134702121707555814304940031111621172348587276244499610702260730757982548888586487676264599",
                "-1.359140914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("0.2568816221949639663664380588811315421639996380618795442680602223822333811199170352584785734925202708",
                "-1.359139914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("0.2586858431749009277437715283103642490535350748018576013033763389895091724129977533859983055361434914",
                "-1.352140914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("0.2617584012361646101242295242187145084392659754321970084879987885232805814595789823848194552497249486",
                "-1.340333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.2635968745187204528773888846153545460049127867634172152637595066583138287915294508973076240201107429",
                "-1.333334333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.2635971381157267700790339456336698995356705824358755598442394944583310611614340155124377565949992129",
                "-1.333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.2635974017129966844187947553884924633233584355332420763606769469358395043933097330481905131685910281",
                "-1.333332333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.2654487913077980808412462310673634018735075419547018500404209798140616442222480368355922725426808366",
                "-1.326333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.3484719460375798285789613065121569261179281057208558261697421897557466901864419893377742749565487919",
                "-1.054197551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("0.3509194562587792489998717358359404766091083652765848711192462239255693287784253067270419560829281129",
                "-1.047198551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("0.3509198071784109675657367159969530583625731536209617406523848978345471913879059177985909098832339147",
                "-1.047197551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("0.3509201580983936059387801363688486417005903027439231198463184662040977826050124168279908300175934587",
                "-1.047196551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("0.3533848634600071681245380172479031141678906863761799880404654645651516586841498745970313029465601948",
                "-1.040197551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("0.3653132771358613466115286248025033838956373294536865640004118456556931863101231683742529177471906249",
                "-1.007"),
            ("0.3678790732921850898124746709315550640860350353502284174957176646800852392817177257240923866815216581",
                "-1.000001"),
            ("0.3678794411714423215955237701614608674458111310317678345078368016974614957448998033571472743459196437",
                "-1.0"),
            ("0.36787980905106743281974434236958229219696404121098793413625793529627768657014873475080794356813565",
                "-0.999999"),
            ("0.3704636313732473623317916389392931510236519333452276672396272338824199106181233236583093381052414879",
                "-0.993"),
            ("0.4012807616935467375810146450288346704181824578977376482561940776037028619363694731035403042153589886",
                "-0.9130939428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("0.4040991772847683302471529504584642160184732901200981688498796978748936228699581772546151904756220407",
                "-0.9060949428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("0.4040995813841476646714754614948020603581630814161182645347402153038744321097241865638098570597972175",
                "-0.9060939428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("0.4040999854839310986771821538707764955061088962326298558698980718163304756760498159186918286984153256",
                "-0.9060929428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("0.4069382020350901383004313073284310454324704805528474039479148026615513845031463980265602339065556814",
                "-0.8990939428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("0.4690715328959387494703302933228586137232030458691534763977543329950098146645803904920329860411873514",
                "-0.757"),
            ("0.4723660803746981493209821811420526362764171712577460331234079238711314966524645987556342534002628303",
                "-0.750001"),
            ("0.472366552741014707138046550943267912970203579136476682395657944141200945633080949683587544259334464",
                "-0.75"),
            ("0.4723670251078036315078519748155006313008043124118929559145234657868600807178775268228891392605361016",
                "-0.749999"),
            ("0.4756847186416878033248472383453966475642421755127748371693919055648621523062854970507192729006876409",
                "-0.743"),
            ("0.5098357486197261562385030111767990794189952529626451590685926806671438436639414548642445620850021847",
                "-0.6736666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.513416605615729702753906351707215352081685247767150220282304886382139778906014148555602432451160088",
                "-0.6666676666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.5134171190325920268719864261265951420597061536273747816521827771884505548322159616830708552284488522",
                "-0.6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.5134176324499677681090991353576068378479487192925073408226021763462130635647391906069258814386181998",
                "-0.6666656666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.5170236469870168708675118279226361794814471954560100885504996389249686206712443790599784577807116456",
                "-0.6596666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("0.6022997704830653896696078660822523967948512022951815488790583552689102525778359409579391920955492518",
                "-0.507"),
            ("0.6065300531822769761991438298901142250333978097507282326718410956300141268666093053716819314251293464",
                "-0.500001"),
            ("0.606530659712633423603799534991180453441918135487186955682892158735056519413748423998647611507989456",
                "-0.5"),
            ("0.606531266243596401668167924060072124106566416048472857912547188013149688902297728047652520918760823",
                "-0.499999"),
            ("0.6107912690658842509559950347375226319621060402219431997006154916936373575526536538844123381018105551",
                "-0.493"),
            ("0.711533105526757943020385684624671259659576473401817629296701023573660005319130343893491059865944021",
                "-0.3403333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.7165305940428369421722187107063293051989324487789611420969093251037674081977349803786990445303468123",
                "-0.3333343333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.7165313105737892504256040969253796674531120598214791571408702071273040772349023791087910889151749462",
                "-0.3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.7165320271054580899895633321057981816219782840833855892641459078145934044788414615699643495152534682",
                "-0.3333323333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.7215646257984048807260265839301290399123952891446582832200582702364184684810842859936747640833485868",
                "-0.3263333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("0.9930244429332351049047970317560145493896511513982182973328997642107980366070853425788091546904901874",
                "-0.007"),
            ("0.9999990000004999998333333749999916666680555553571428819444416887127976190225669413212814384689499397",
                "-0.000001"),
            ("1.00000100000050000016666670833334166666805555575396827876984402557346781307619849495283539120345823",
                "0.000001"),
            ("1.007024557266848555231600031941337387260626958324843573515364689887121935057426030048643842343378402",
                "0.007"),
            ("1.385877250971815364059642120906716989703534645450984919905573096098162291700329038709134856644405885",
                "0.3263333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("1.395611029474362248518537723544405791384975649850566166579921929905549174428183356326731560382097554",
                "0.3333323333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("1.395612425086089528628125319602586837597906515199406982617516706031739015645951846969788817295830224",
                "0.3333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("1.395613820699212421162799121490431432975110720910417101081098948093211345333527476176219029192513399",
                "0.3333343333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("1.405415984488432153726569341255990466438982424240368939639676573125749681712931769088988831312060536",
                "0.3403333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("1.637220521389170270373479862882128577789332578881046885721027825136812720558631818436483917948022518",
                "0.493"),
            ("1.648719621979681807081067193483484598239709905370028996991319293722745345337091787772475169247667094",
                "0.499999"),
            ("1.648721270700128146848650787814163571653776100710148011575079311640661021194215608632776520056366643",
                "0.5"),
            ("1.648722919422223207886934647685130420870915144983653557851791318969353578294629906217233849311645004",
                "0.500001"),
            ("1.660302807683232515989430438904161379294002367817914660467787737489583553029887653907670746152110028",
                "0.507"),
            ("1.934147511100418366160140702182435226347678491502285932098678352482514618719429002540940341367628883",
                "0.6596666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("1.947732093321608668659069647815246400008940789023428634580118060819428959815994224117558140167260985",
                "0.6666656666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("1.94773404105467585663902120792834531435960408718297218705469756522268474481810255562609699046708681",
                "0.6666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("1.947735988789690778660027606209253337813260822911572422749691905229480938365774451196557267917966455",
                "0.6666676666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("1.961416010366654782141352035286649868263579696600964258687784557498394201711683254909541376962957918",
                "0.6736666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("2.10223276218645072544678732030405766237466117862744281195962774674575741953956434651518838572503304",
                "0.743"),
            ("2.116997899613716555526174363907752397055484722525352615651552063127006671897249859236333725069346737",
                "0.749999"),
            ("2.117000016612674668545369819837095610134491584702403421779133030810984533364012820002791560266615798",
                "0.75"),
            ("2.117002133613749781581178126851652244095438476872109018338598066031569425777355992946376397439079432",
                "0.750001"),
            ("2.131871004463289744535388378676364140023371811320128206736322237423447008619087857606595855786799447",
                "0.757"),
            ("2.457375579385319914160496072389555821768936254543191335571273253825180099971666083875753664868185213",
                "0.8990939428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("2.474635080232549691378893317294706703411254632588031374828459479149093466975601128686320716140057849",
                "0.9060929428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("2.47463755486886724188114025418228735832509702243612582304811430127668864097139036880550653276398982",
                "0.9060939428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("2.474640029507659429938256264531545392572265849612202415235922546315225958967351081661209385837264602",
                "0.9060949428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("2.492020788087737683585783685856465787316749636352734256350900211032411504931249140513710658350224658",
                "0.9130939428196817451200958237842208325857490312333198583223225425746922101178491981904607261750554758"),
            ("2.699320298441079142039188705027787063552641965700722591396869023524215100059842358491020135294666788",
                "0.993"),
            ("2.718279110178575916776234775534750616385800794667057828284978303023762678481264593707589706180563379",
                "0.999999"),
            ("2.718281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427",
                "1.0"),
            ("2.71828454674223283577279943892942037152803311811140533084260734799371791729012640262427067462984527",
                "1.000001"),
            ("2.737376554830489599418262482263764631669089408725967838150732777224612482008642370534015263668549378",
                "1.007"),
            ("2.829775984768998899705523016565887028739137227271476088087340997469538224020256574289888918560679897",
                "1.040197551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("2.849651058573878097591800827172150450793635731490921687654926195447789830141269082988526622400227763",
                "1.047196551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("2.849653908226361497474127319852904393964006102781126881743238778488142449158841450547344562771017082",
                "1.047197551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("2.849656757881694551264680411502291483325603206609868326299007151894125986205149028557347884773508206",
                "1.047198551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("2.869671465295396371036026797912057620082778945586027732369630732586061474905968300653900444998216342",
                "1.054197551196597746154214461093167628065723133125035273658314864102605468762069666209344941780705689"),
            ("3.767204947791461393147354657973291230366164004056878213464924212020220121077806412676778773399816435",
                "1.326333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("3.793664101017179885533632728690770670349154087737024665660158831149939289147528391133627502007289213",
                "1.333332333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("3.793667894683177735396304360505165314661714629412615875592525513751921430417245346031174008779637453",
                "1.333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("3.793671688352969253153659486193947486943462919135685635249930623692231907350345551317625514575741247",
                "1.333334333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("3.820316732060784511064438385157008690961860947557113176310324709719865184819518195733666234018144864",
                "1.340333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("3.865692794498563819241505419774520163157648179245803069805192876671089350941071695643965769857257834",
                "1.352140914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("3.892843682063934317964895976181877080374210539423310904157752831706771037163110763695224866724943061",
                "1.359139914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("3.892847574909562804389053350782677289600218357636255285959544495230312125013180228358489514457029353",
                "1.359140914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("3.892851467759084138388120612591831127984722684379105874451869657373975902602690488139618439047574232",
                "1.359141914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("3.920193105630627549255018818946070278170073478831880886267904687573285337019797124495824995985317153",
                "1.366140914229522617680143735676331248878623546849979787483483813862038315176773797285691089262583214"),
            ("4.450426792472425141531861319313021262342496114855433373849945710549270245104623095412133630768498973",
                "1.493"),
            ("4.481684588651235328325453898822446507042987282318901481560609136599583106186932802247198857797577295",
                "1.499999"),
            ("4.481689070338064822602055460119275819005749868369667056772650082785936674466713772981053831382453391",
                "1.5"),
            ("4.481693552029376005948995459712796381279816083383888238605945684795981417342495777871127796066740601",
                "1.500001"),
            ("4.513170951864863821635083778265173211738954004127984899501854477655344781667775080482332748629889751",
                "1.507"),
            ("4.776921621476046112277240717193519460469343090501597092781562207158817771607316762855305087418060148",
                "1.563796326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("4.810472570490375928010116839771528450729715941015788098239036475760177934975280392114576229947109877",
                "1.570795326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("4.810477380965351655473035666703833126390170874664534940020815489242551904891582136748704766583883355",
                "1.570796326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("4.81048219144513786031692024616472591817666336802865928232128301079131520781744432559321215509536871",
                "1.570797326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("4.84426885480882242228684567712212107603609044981498971715019875952662378539823424776396521130583624",
                "1.577796326794896619231321691639751442098584699687552910487472296153908203143104499314017412671058534"),
            ("6.081113895164554037812211896364610863350582431194404039456465600600856032785126953862492663967950452",
                "1.805187885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("6.123824904139399876281289118285413321631645690240676282563245405554686493353425292807214521493708562",
                "1.812186885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("6.12383102796736592915387283869532760200869286856267189231518697370203180955782302004455152455929332",
                "1.812187885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("6.123837151801455813054424435353648085855273445720433517555434081847095549434906919862568289847337626",
                "1.812188885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("6.166848229715826747558607827253032992115012874309882989715313638922648630545532233060318622055205593",
                "1.819187885639363490240191647568441665171498062466639716644645085149384420235698396380921452350110952"),
            ("7.33751331644303228222564411384711425350867168086515501999095753856089673413379967851062429063712513",
                "1.993"),
            ("7.389048709878245823398156513316663294017582939678715314155774905848570879225492231885333229448498192",
                "1.999999"),
            ("7.389056098930650227230427460575007813180315570551847324087127822522573796079057763384312485079121795",
                "2.0"),
            ("7.38906348799044368716162967381525767071166730093747798132485247796186854404832617644223422924221792",
                "2.000001"),
            ("7.440960946645545163323557237281715850192509391696453191271970581084833898862845434673193268005851286",
                "2.007"),
            ("8.063882194402078521222177606912262414105431787129690818346785029564648448386011036540021564588454086",
                "2.087395102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("8.120519276146439908415595766092767945998434854835976516299160062710507094172711345824426031337494078",
                "2.094394102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("8.120527396669776315846997619355519331825602436514214454566685861254062717156899080591433803053177196",
                "2.094395102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("8.120535517201233250675069925644734104442708878653718278578627957762231968246654230475657815150826387",
                "2.094396102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("8.17757050640469577327487088391776693072277219418224313567584652930881841881156435800526562905011727",
                "2.101395102393195492308428922186335256131446266250070547316629728205210937524139332418689883561411379"),
            ("9.421553593597616464145229108247203059751425437009964136316435695964620252269261881441124284439367857",
                "2.243"),
            ("9.487726348627433228361538846265462260282108336783064576400743151932178947438925326699047646460541629",
                "2.249999"),
            ("9.48773583635852572055036904451173842377022496766238701010344881596754893239630805839045982212932139",
                "2.25"),
            ("9.487745324099105948575558559123217986206351537930563086819809374904973897021890738227382587309982586",
                "2.250001"),
            ("9.554382980073757457261690156446752398952293883916890755677343158576003758115784695667107067292392498",
                "2.257"),
            ("15.04855282040910508928913910967546304984357646876284450312037878816642569449985547228147387907230724",
                "2.711281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("15.15424708722459983909127040214210923526459608174476318244751991143168363848938983188074751079818262",
                "2.718280828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("15.15426224147926418976043027262991190552854853685613976914074640591483097373093443260845696835787346",
                "2.718281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("15.15427739574908280267107067016266179604590855680189966464567164248167200364360599746325958891336621",
                "2.718282828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("15.2607142244313760301189915620993435725056288573880903961039677001377430744090965373497630550970412",
                "2.725281828459045235360287471352662497757247093699959574966967627724076630353547594571382178525166427"),
            ("19.94542911416335877729717102717037956085801991297425921930480896800069748993157284091159561996771039",
                "2.993"),
            ("20.08551683766078731837479390962178737664890598369683822115919624136712176095076986513548027603483871",
                "2.999999"),
            ("20.0855369231876677409285296545817178969879078385541501443789342296988458780919737312044971602530177",
                "3.0"),
            ("20.08555700873463370040545474107732054600959631347255459727824758782934667421550960996149700958124419",
                "3.000001"),
            ("20.226628927540000643675329467522585298730078768972821941153671528652628453831702080825769666355267",
                "3.007"),
            ("22.97927341075485123030344572022442964748579538263544194428510505868164899624053557212269837775806615",
                "3.134592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("23.14066949209820656891968913209716600067759444661701553980496002898391965946084930343652409005745557",
                "3.141591653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("23.14069263277926900572908636794854738026610624260021199344504640952434235069045278351697199706754922",
                "3.141592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("23.14071577348347213517126480119671057789259676514525988857441258852595466956808762977802273555442941",
                "3.141593653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("23.30324575337276744539384238272956780338912591229550340317558281177345366984481782553094797106184541",
                "3.148592653589793238462643383279502884197169399375105820974944592307816406286208998628034825342117068"),
            ("27.8360886954002195800527505118457650811020171953722599321761072254911468450549862751771901225574248",
                "3.326333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("28.03159686291525539361278467446858656920682206081061320494806484439268547674242996193485376747049138",
                "3.333332333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("28.0316248945261341119715698934193795472145214799722244996301234767710323669786328964490625434215832",
                "3.333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("28.03165292616504445522488358245088530570468190101889319706462168289866940442073069851028477036919302",
                "3.333334333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("28.22853464888055053292921008697085046041498139827955148916984654387633117216294577907396790328092981",
                "3.340333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333"),
            ("54.21729752184824978984424803786472122412461025449427505026114827596346762768047301914344765906259661",
                "3.993"),
            ("54.59809543502150499978806581487048722266423729230546924548357475015241335308325364008799131772797516",
                "3.999999"),
            ("54.59815003314423907811026120286087840279073703861406872582659395855366209993586948167698056194473414",
                "4.0"),
            ("54.59820463132157130646560537977521593962501570038374033173996952043491195879923782235617060509893933",
                "4.000001"),
            ("54.98167786471605012939874978114765523828265589502335987434152853958108008601642058098884845988718125",
                "4.007"),
            ("58.5817223528280463396783825190034172356261940276256142300354491131140914686632820288528560687074126",
                "4.070422742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("58.99317402308258935578789256485207686460623592719855007138019106842967846258787385255795218332502204",
                "4.077421742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("58.99323301628610903522098777598570979390352582104155931634897687686503049211245801984759415968456508",
                "4.077422742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("58.99329200954862194767037401225731506831642445147269553729742752636986119524573525817767730967473974",
                "4.077423742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("59.4076343599655517352841869257302115282653918169892539500570065831948654073064648560819714326822721",
                "4.084422742688567853040431207028993746635870640549939362450451441586114945530321391857073267787749641"),
            ("89.38921166414855518190280360096328974687634776513065176929937956065413286698863938168671108448804902",
                "4.493"),
            ("90.01704128343552157894931607085209145602642134060016917378981852177431023143764861683784573271524077",
                "4.499999"),
            ("90.01713130052181355011545674557436084792730752976927472270388623292353061763991787725528433903790649",
                "4.5"),
            ("90.01722131769812265258212673527435407364161150968693476867470688042454986443551702850210874658206408",
                "4.500001"),
            ("90.64946179433975459277910230436082568067662873829077432305043835912457530184644708706192806137562768",
                "4.507"),
            ("110.5412749734547401972796025258757312821767346863880616805160364203987538993156457748286432768402052",
                "4.705388980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("111.3176671721333950413069507615914691112397739113945186022369854338154607222431962717372949651565117",
                "4.712387980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("111.3177784898562260268410079329888431712466750718968363384165223467298686371728191948341099181306883",
                "4.712388980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("111.3178898076903747908649306068945990608479500303484457594168704807110852892669126442399280539858496",
                "4.712389980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("112.0997365996765833699808532500569115547866318317979428352591407263780231135501518016287617387984881",
                "4.719388980384689857693965074919254326295754099062658731462416888461724609429313497942052238013175602"),
            ("147.3778946417977224788539988784917618080258155270228106565449493934289236062807951099314864068839847",
                "4.993"),
            ("148.4130106894917073993279268934670887889478073389138339322951444250865755067253866412295480068894707",
                "4.999999"),
            ("148.4131591025766034211155800405522796234876675938789890467528451109120648209585760796884094598990211",
                "5.0"),
            ("148.4133075158099126020058221588218445865306239967175775794280032837905044799225536252806892454343389",
                "5.000001"),
            ("149.4556958378465587025937572245394794019112819292015740436474259587813013717284666912924422954934525",
                "5.007"),
            ("228.0497157952319879017557418638944848192176418697368735552381499217792171520321024273826058936855512",
                "5.429563656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("229.6514344319748747795635731546739105466254308484298402039866715997140556636806416384242474902780569",
                "5.436562656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("229.6516640835241325099295887964443412315995859318507625144541433636989781161736186439745266914649635",
                "5.436563656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("229.6518937353030419043791477083633751330191491397565958740832977149299739433955237121036001204332953",
                "5.436564656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("231.2648653493059153068422890639602329529713409257249687466794894184938933067220074382838553525521701",
                "5.443563656918090470720574942705324995514494187399919149933935255448153260707095189142764357050332855"),
            ("400.6146529213504385988036247480792613803749321523100687570440472650029095628792698894464541224064719",
                "5.993"),
            ("403.4283900641433442027728242782524429977387757519420592777124151936798091338878441847310164121412511",
                "5.999999"),
            ("403.4287934927351226083871805433882796058998973571292026139671883251511806339934983051788866512126648",
                "6.0"),
            ("403.4291969217303298074943055501986277903185934783337975929745724430590616920716568901844145403256639",
                "6.000001"),
            ("406.262702155720460245415676895953210640700330961006999399618401734802285201337727634442613660731314",
                "6.007"),
            ("531.7563029228753309665148457085148673297652278132535178868186517307401801436447148888775467561394927",
                "6.276185307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("535.4911200333769574768266219659895121137223413485156233955982628269426215844392597230795818119647728",
                "6.283184307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("535.4916555247647365030493295890471814778057976032949155072052550373144945439662721360915389830461886",
                "6.283185307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("535.4921910166880071847968465729125272366938197812316300004974454340969966688060607482658026185826775",
                "6.283186307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("539.2532473249179859215661014532068468277047414322958335370199823443525284041680486179166574088401253",
                "6.290185307179586476925286766559005768394338798750211641949889184615632812572417997256069650684234136"),
            ("780.2907968402182942797891571259852247624185605113816567921146244617186218908548301160138908833571813",
                "6.659666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("785.7712084558159578265788658188293237882174079474488051230014307436623943808596854299945740482030012",
                "6.666665666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("785.771994227417299377726501193051325441707145426863795527891188740415521612484588305933068164377114",
                "6.666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("785.7727799998044129231016193476505725500142490262273461964307100148813301627245861881149361003667383",
                "6.666667666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("791.2916945995535845610308722137194221241966772151727061782773495067179176847992334250884652235988278",
                "6.673666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666667"),
            ("3455.925197255761464360644112836894117699561703089352654560665829839285076117155160099038826557534937",
                "8.147845485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("3480.198061514027836583004472041477177122653683890069868356982690914887363972477471835955144667735125",
                "8.154844485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("3480.201541713829450221631224224860258339525040772337532704505790271472473902800490394071562115099283",
                "8.154845485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("3480.205021917111265401972095875260113609409336220307550821927570058915849526387809457162289529726127",
                "8.154846485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("3504.648416743772876204114135923708812185895521799628174040263436100343120670478959748112941897722839",
                "8.161845485377135706080862414057987493271741281099878724900902883172229891060642783714146535575499282"),
            ("12305.20916148132244102027545123875522653914093875362396025039097520452640299290874092973164729729681",
                "9.417777960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("12391.63541627508538664774362588655127354795288544562232951442772835273544636274685762361694090375034",
                "9.424776960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("12391.64780791669748150654090202092753812769765658739807581054232308752248152339716879929970274405749",
                "9.424777960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("12391.66019957070122417325590827412767003534139138992368473201605507869552979822331373533327934326979",
                "9.424778960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("12478.69364757402668869853435589147517505754263269565335848793505222492508826760053518464497856957335",
                "9.431777960769379715387930149838508652591508198125317462924833776923449218858626995884104476026351204"),
            ("21872.81892567589728380267244559305180152288308734249600142210061388644273834401110044113288161695299",
                "9.993"),
            ("22026.44376835193493946771033094351650936762873952175236587616456027242839398666425300861104454441222",
                "9.999999"),
            ("22026.4657948067165169579006452842443663535126185567810742354263552252028185707925751991209681645259",
                "10.0"),
            ("22026.48782128352456024289951168074635793890844899101459625223167316681447142680454760684976157503066",
                "10.000001"),
            ("22181.19196516861717531654187344424005133914521753670286804264530836043513694687646384495794309214088",
                "10.007"),
            ("3246214.155238185598689602001650100554022198782360384114502173201016647669371584562100924343326285974",
                "14.993"),
            ("3269014.103456372675332615707020004322621539395636852562802751980052624247573274207479504665029309262",
                "14.999999"),
            ("3269017.372472110639301855046091721315505738543820034206629562773242021332748879132969874112289258912",
                "15.0"),
            ("3269020.64149111762064356676822085453612099662561906478835089233101348705452860529513153281673908552",
                "15.000001"),
            ("3291980.772211363774269121396847884109993893679659735699055723667556064929884345023920454065406919729",
                "15.007"),
            ("481780897.9024011441517091850336952113221140797616495961892933468307614083767602542238821171168819754",
                "19.993"),
            ("485164710.2448374506956729108872752899298069437416627399379665659713826536752154072969014098461780703",
                "19.999999"),
            ("485165195.4097902779691068305415405586846389889448472543536108003159779961427097401659798506527473494",
                "20.0"),
            ("485165680.5752282704379505809042078850872167532306461721688945239039892704487144852586857515332068555",
                "20.000001"),
            ("488573266.1088281195785061089946060670955583087479085487969092103623477430049349791757192424808969832",
                "20.007"),
            ("10611930468238.5057600167605028111176278808838132008153252678637696027473412824272308575475528843276",
                "29.993"),
            ("10686463895055.22385803800523969518762802905665111847122088178576545329035938160283497948591517004324",
                "29.999999"),
            ("10686474581524.46214699046865074140165002449500547305499022291149210845294478713153253805768680152521",
                "30.0"),
            ("10686485268004.38691052445741447415460107220499563206374128879697068707322760063127473182749380662695",
                "30.000001"),
            ("10761542334203.10218083536585173320739849878696666199861580431185700839478222191229638654108732853672",
                "30.007"),
        };

        return composites
            .Select(item =>
            {
                var operand1 = BigDec.Parse(item.Item1);
                var operand2 = BigDec.Parse(item.Item2);
                return new object[] { operand1, operand2 };
            })
            .ToArray();
    }

    private const int PickedPrecision = 50;

    private static int GetLg10Ceiling(BigDec input)
    {
        int lg10;
        var t = input.Abs().Round(0);
        for (lg10 = 1; t >= 10; lg10++)
        {
            t /= BigDec.BigInteger10;
        }

        return lg10;
    }

    [Theory]
    [MemberData(nameof(TestLnPickedData))]
    public void TestLnPicked(BigDec input, BigDec expectedLn)
    {
        var lg10 = GetLg10Ceiling(input);
        var localPrecision = (PickedPrecision - 2) - lg10;
        var epsilon = BigDec.PowFracOfTen(localPrecision);

        {
            var actualLn = input.WithPrecision(PickedPrecision + 2).Ln();
            Assert.InRange(actualLn, expectedLn - epsilon, expectedLn + epsilon);
        }
        {
            var actualExp = expectedLn.WithPrecision(PickedPrecision + 2).Exp();
            Assert.InRange(actualExp, input - epsilon, input + epsilon);
        }
    }

    #endregion

    #endregion

    #region Exceptions

    [Fact]
    public void ThrowLnOnZero()
    {
        Assert.Throws<InfiniteDecimalException>(() => { BigDec.Zero.Ln(); });
    }

    [Fact]
    public void ThrowLnOnNegative()
    {
        Assert.Throws<InfiniteDecimalException>(() => { new BigDec(-0.5m).Ln(); });
        Assert.Throws<InfiniteDecimalException>(() => { new BigDec(-1).Ln(); });
        Assert.Throws<InfiniteDecimalException>(() => { new BigDec(-2).Ln(); });
    }

    #endregion

    #region Power

    #region TestPow

    public static object[][] TestPowData()
    {
        var values = GetTestDecimal(true);
        decimal[] exps = new[] { 0, 1.5m, 2m, (decimal)Math.E, (decimal)Math.PI, 1337m, 0.000001m, 1_000_000m, }
            .SelectMany(t => new decimal[]
                { t, t + 0.000001m, t + 0.007m, t - 0.000001m, t - 0.007m, })
            .ToArray();
        exps = exps
            .Concat(exps.Select(exp => -exp))
            .Distinct()
            .OrderBy(t => t)
            .ToArray();

        return values
            .OrderBy(t => t)
            .Distinct()
            .SelectMany(value => exps.Select(exp => new object[] { value, exp }))
            .ToArray();
    }

    [Theory]
    [MemberData(nameof(TestPowData))]
    public void TestPowThroughDouble(decimal value, decimal exponent)
    {
        var expected = Math.Pow((double)value, (double)exponent);
        if (!double.IsFinite(expected))
        {
            return;
        }

        /*
        {
            var v1 = new BigDec(expected + 0.000_000_1d);
            var v2 = new BigDec(expected - 0.000_000_1d);
            var diff = v1 - v2;
            if (diff >= 0.000_000_201m)
            {
                // Debugger.Break();
            }
        }
        */

        var valueBI = new BigDec(value);
        var exponentBI = new BigDec(exponent);

        // ReSharper disable once ConvertIfStatementToSwitchStatement
        if ((expected == 0) && (value != 0))
        {
            // Too small value for 64-bit IEEE-754
        }
        else if (expected == 0)
        {
            var actual1 = valueBI.Pow(exponentBI);
            Assert.Equal(BigDec.Zero, actual1);

            var actual2 = valueBI.Pow(exponent);
            Assert.Equal(BigDec.Zero, actual2);
        }
        else if (expected == 1)
        {
            var actual1 = valueBI.Pow(exponentBI);
            Assert.Equal(BigDec.One, actual1);

            var actual2 = valueBI.Pow(exponent);
            Assert.Equal(BigDec.One, actual2);
        }
        else
        {
            var lg10 = Math.Log10(expected);
            if (lg10 >= 10)
            {
                // This case can't be checked with double precision
                return;
            }

            var rangeMin = new BigDec(expected) - 0.000_000_1m;
            var rangeMax = new BigDec(expected) + 0.000_000_1m;

            var actual1 = valueBI.Pow(exponentBI);
            Assert.InRange(actual1, rangeMin, rangeMax);

            var actual2 = valueBI.Pow(exponent);
            Assert.InRange(actual2, rangeMin, rangeMax);
        }
    }

    #endregion

    #region TestPow: picked

    public static object[][] TestPowPickedData()
    {
        var composites = new[]
        {
            (1234, "2.71128182845904",
                "240672582.7243143955660827053990682468790796458765518397902180169903333216369065798587903982833279877"),
            (1234, "0.71128182845904",
                "158.050654684213620281964218429655339975071282514435562749526527552893123807692486425133375460893267"),
            (1234, "2.71828082845904",
                "252966337.6971038142844835303627077417943097974215975692280507741512229112502862512644315035963065971"),
            (1234, "2.71828182845904",
                "252968138.3220031575223763399835647529485175878056590543726503285322740089840420271470239450339347846"),
            (1234, "2.71828282845904",
                "252969938.9597194235874361485203938280114167492358643152922377444789264363406627268258207813614739357"),
            (1234, "2.72528182845904",
                "265891853.0799275907185185162721469493441104149745317703731093848029034341135430259542740066975555176"),
            (1234, "3.13459265358979",
                "4897943708.460388073809069147169782292584320299572287681394398234729409319225192789745956535619772042"),
            (1234, "3.14159165358979",
                "5148134732.052392346084129616711433272539316038081380179968444955144812655008345205464601854251409863"),
            (1234, "3.14159265358979",
                "5148171376.689256270590485156919616667886164738458053824241855025127332099990379131308418560763003203"),
            (1234, "3.14159365358979",
                "5148208021.586958242424625544790361553097218798814157691525495120809736617707236229422182896593658323"),
            (1234, "3.14859265358979",
                "5411182753.689440355944578918490925500560752639741015597877579512197057922707396626496827975217903052"),
            (911, "2.71828182845904",
                "110867696.7138477331853885947187209125245628949725938945430285937483974719573432555097243069281578248"),
            (911, "2.72528182845904",
                "116284452.8536968949841385705284162347388822156758712860803705742491119796827466982670471512401469927"),
            (911, "3.13459265358979",
                "1891840692.261465470110264558535147507874895094857483541865315464299878614153076464975383795309383506"),
            (911, "3.14159165358979",
                "1984258419.441048239202676423398991115651978451137966668333815536334847122691842146904225304020176564"),
            (911, "3.14159265358979",
                "1984271941.30123936530340288018192631222290689740536962475721245903313128206979586268985315744669438"),
            (911, "3.14159365358979",
                "1984285463.253576101692060351710140112028011627280358744214043960015173486067149035948755885819106179"),
            (911, "3.14859265358979",
                "2081219181.478110509738128391909214469480121098995847610324776991206267666214375218249429954403413924"),
        };

        return composites
            .Select(item =>
            {
                return new object[]
                {
                    item.Item1,
                    BigDec.Parse(item.Item2),
                    BigDec.Parse(item.Item3),
                };
            })
            .ToArray();
    }

    [Theory]
    [MemberData(nameof(TestPowPickedData))]
    public void TestPowPicked(decimal value, BigDec exponent, BigDec expected)
    {
        var actual = new BigDec(value).Pow(exponent.WithPrecision(PickedPrecision));
        var lg10 = GetLg10Ceiling(actual);

        Assert.True(lg10 < 18);
        var localPrecision = (PickedPrecision - 2) - lg10;
        var epsilon = BigDec.PowFracOfTen(localPrecision);
        Assert.InRange(actual, expected - epsilon, expected + epsilon);
    }

    #endregion

    [Fact]
    public void TestPow_Case1()
    {
        TestPowThroughDouble(2.71826182845904m, -1000000.007m);
    }

    [Fact]
    public void TestPow_Case2()
    {
        TestPowThroughDouble(14, 0.007m);
    }

    [Fact]
    public void TestPow_Case3()
    {
        TestPowThroughDouble(7.95484548537712m, 0m);
    }

    [Fact]
    public void TestPow_Zero_Zero()
    {
        var expected = BigDec.Zero.Pow(BigDec.Zero);
        Assert.Equal(BigDec.One, expected);
    }

    #endregion
}